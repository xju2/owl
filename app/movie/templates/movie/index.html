{% extends "bbase.html" %}

{% block title %} 电影推荐 {% endblock %}

{% block content %}
    <div class="container">
        <h1>
            <a href="/">
                <i class="icon-arrow-left-3 fg-darker smaller"></i>
            </a>
            Movie</h1>
        <div class="grid no-margin">
	{% if user.username %}
    	{% load humanize %}
    	{% if user.realrate_set.all.count < 1 %}
        <p>You have not rated any movies yet</p>
    	{% else %}
        <p>You are: {{ user.first_name }} {{ user.last_name }}. So far you have rated {{ user.realrate_set.all.count|intcomma }} movies.
            But your favored movies are (top 10) :</p>
        <ul>
        {% for real_rate in user.movie_realrate_related.top_10 %}
            <li><a href="{% url 'detail' real_rate.movie.id %}">{{ real_rate.movie.name }} is rated as {{ real_rate.rate }}</a></li>
        {% endfor %}
        </ul>
    	{% endif %}

    	<p>In any case, we bring those movies to your attention. </p>
        <ul>
        {% for movie in suggest %}
            <li><a href="{% url 'detail' movie.id %}">{{ movie.name }}</a></li>
        {% empty %}
            {% for movie in top10_movies %}
                <li><a href="{% url 'detail' movie.id %}">{{ movie.name }} is rated as {{ movie.get_ars|floatformat:2 }}</a></li>
            {% empty %}
                <p>Nothing to recommend</p>
            {% endfor %}
        {% endfor %}
        </ul>
	{% endif %}
        </div>
    </div>

{% endblock %}
